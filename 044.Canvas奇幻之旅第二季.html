<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./assets/global.css" />
    <link
      rel="stylesheet"
      href="./assets/highlight/styles/github-dark.min.css"
    />
    <script src="./assets/highlight/highlight.min.js"></script>
    <!--å¼•å…¥ä»£ç é«˜äº®js-->

    <style>
      .container {
        display: flex;
        flex-wrap: wrap;
        padding: 20px;
      }

      .container canvas {
        margin-right: 20px;
        border: 1px dashed salmon;
      }

      pre {
        margin: 0;
      }
    </style>
  </head>

  <body>
    <script type="module">
      import {
        Maths,
        Randoms,
        Animation,
        v2,
        Vector2,
      } from "https://gcore.jsdelivr.net/npm/@3r/tool/index.js";

      /**
       * åˆ›å»ºç”»å¸ƒ
       * @typedef {Object} IRenderParam
       * @property {HTMLCanvasElement} IRenderParam.canvas
       * @property {CanvasRenderingContext2D} IRenderParam.context
       *
       *
       * @param {Object} params
       * @param {number} params.width - ç”»å¸ƒå®½åº¦
       * @param {number} params.height - ç”»å¸ƒé«˜åº¦
       * @param {(param:IRenderParam)=>void} params.render - æ¸²æŸ“æ–¹æ³•
       */
      function createCanvas({ width, height, render }) {
        const container = document.createElement("div");
        const canvasContainer = document.createElement("div");
        const canvas = document.createElement("canvas");
        const codeContainer = document.createElement("div");
        const codePre = document.createElement("pre");
        const code = document.createElement("code");

        canvas.width = width;
        canvas.height = height;
        const context = canvas.getContext("2d");

        container.classList.add("container");
        codeContainer.classList.add("code");
        code.classList.add("hljs", "language-html");

        codePre.appendChild(code);
        codeContainer.appendChild(codePre);
        canvasContainer.appendChild(canvas);
        container.appendChild(canvasContainer);
        container.appendChild(codeContainer);

        let codeTextContent = render.toString();
        codeTextContent = codeTextContent.split("\n");
        let codeStartLine = codeTextContent.findIndex((line) =>
          line.includes("//")
        );
        codeTextContent = codeTextContent.slice(
          codeStartLine,
          codeTextContent.length - 1
        );
        codeTextContent = codeTextContent.map((line) =>
          line.replace("                ", "")
        );
        codeTextContent = codeTextContent.join("\n");
        code.textContent = codeTextContent;
        document.body.appendChild(container);
        render({
          canvas: canvas,
          context,
        });
      }

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // lineCap å±æ€§
          context.beginPath();
          context.moveTo(20, 20);
          context.lineTo(180, 20);
          context.strokeStyle = "blue";
          context.lineWidth = 10;
          context.lineCap = "butt"; // é»˜è®¤
          context.stroke();

          context.beginPath();
          context.moveTo(20, 70);
          context.lineTo(180, 70);
          context.strokeStyle = "blue";
          context.lineWidth = 10;
          context.lineCap = "round"; // åœ†
          context.stroke();

          context.beginPath();
          context.moveTo(20, 120);
          context.lineTo(180, 120);
          context.strokeStyle = "blue";
          context.lineWidth = 10;
          context.lineCap = "square"; // æ–¹
          context.stroke();

          context.beginPath();
          context.moveTo(20, 170);
          context.lineTo(180, 170);
          context.strokeStyle = "blue";
          context.lineWidth = 10;
          context.lineCap = "square"; // æ–¹
          context.closePath(); // ä¼šä½¿lineCapä¸ç”Ÿæ•ˆ
          context.stroke();

          // è¾…åŠ©è§‚å¯Ÿçº¿
          context.beginPath();
          context.moveTo(20, 0);
          context.lineTo(20, 300);
          context.moveTo(180, 0);
          context.lineTo(180, 300);
          context.strokeStyle = "red";
          context.lineWidth = 1;
          context.lineCap = "butt"; // é»˜è®¤
          context.stroke();

          // çŸ©å½¢ä¸€è§’æœªå°å£é—®é¢˜
          context.beginPath();
          context.moveTo(20, 200);
          context.lineTo(80, 200);
          context.lineTo(80, 260);
          context.lineTo(20, 260);
          context.lineTo(20, 200);
          context.strokeStyle = "blue";
          context.lineWidth = 10;
          // ä¸¤ç§æ–¹å¼ä»»é€‰å…¶ä¸€
          // context.lineCap = 'square'
          // context.closePath();
          context.stroke();
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // lineJoin å±æ€§
          context.beginPath();
          context.moveTo(20, 20);
          context.lineTo(180, 20);
          context.lineTo(20, 50);
          context.strokeStyle = "blue";
          context.lineWidth = 10;
          context.closePath();
          context.lineJoin = "miter"; // é»˜è®¤
          context.stroke();

          context.beginPath();
          context.moveTo(20, 70);
          context.lineTo(180, 70);
          context.lineTo(20, 100);
          context.strokeStyle = "blue";
          context.lineWidth = 10;
          context.closePath();
          context.lineJoin = "bevel";
          context.stroke();

          context.beginPath();
          context.moveTo(20, 120);
          context.lineTo(180, 120);
          context.lineTo(20, 150);
          context.strokeStyle = "blue";
          context.lineWidth = 10;
          context.closePath();
          context.lineJoin = "round";
          context.stroke();

          context.beginPath();
          context.moveTo(20, 170);
          context.lineTo(180, 170);
          context.lineTo(20, 200);
          context.strokeStyle = "blue";
          context.lineWidth = 10;
          context.closePath();
          context.lineJoin = "miter"; // é»˜è®¤
          context.miterLimit = "1"; // å¦‚æœæ–œæ¥é•¿åº¦è¶…è¿‡ miterLimit çš„å€¼ï¼Œè¾¹è§’ä¼šä»¥ lineJoin çš„ "bevel" ç±»å‹æ¥æ˜¾ç¤ºã€‚
          context.stroke();
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // ç»˜åˆ¶æ˜Ÿæ˜Ÿâ­
          function drawStar(x, y, R, r, color) {
            // let R = 100
            // let r = 40
            context.beginPath();
            for (let i = 0; i < 5; i++) {
              // å¤–è§’
              context.lineTo(
                R * Math.cos(((18 + i * 72) / 180) * Math.PI) + x,
                -R * Math.sin(((18 + i * 72) / 180) * Math.PI) + y
              );
              // å†…è§’
              context.lineTo(
                r * Math.cos(((54 + i * 72) / 180) * Math.PI) + x,
                -r * Math.sin(((54 + i * 72) / 180) * Math.PI) + y
              );
            }
            context.fillStyle = color;
            context.closePath();
            context.fill();
          }

          drawStar(150, 150, 100, 40, "yellow");
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // translate ç§»åŠ¨ç”»å¸ƒ
          context.beginPath();
          context.moveTo(50, 50);
          context.lineTo(120, 50);
          context.lineTo(120, 120);
          context.lineTo(50, 120);
          context.fillStyle = "#f0f";
          context.closePath();
          context.fill();

          context.beginPath();
          context.translate(50, 50);
          context.moveTo(50, 50);
          context.lineTo(120, 50);
          context.lineTo(120, 120);
          context.lineTo(50, 120);
          context.fillStyle = "#f0f";
          context.closePath();
          context.fill();

          context.beginPath();
          context.translate(50, 50); // å åŠ æ€§
          context.moveTo(50, 50);
          context.lineTo(120, 50);
          context.lineTo(120, 120);
          context.lineTo(50, 120);
          context.fillStyle = "#f0f";
          context.closePath();
          context.fill();

          // ç›–ä½ç¬¬ä¸€ä¸ª
          context.beginPath();
          context.translate(-100, -100); // å åŠ æ€§
          context.moveTo(50, 50);
          context.lineTo(120, 50);
          context.lineTo(120, 120);
          context.lineTo(50, 120);
          context.fillStyle = "#ff0";
          context.closePath();
          context.fill();
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // save restore ä¿å­˜å’Œæ¢å¤ç”»å¸ƒ
          context.beginPath();
          context.moveTo(50, 50);
          context.lineTo(120, 50);
          context.lineTo(120, 120);
          context.lineTo(50, 120);
          context.fillStyle = "#f0f";
          context.closePath();
          context.fill();

          context.save();
          context.beginPath();
          context.translate(50, 50);
          context.moveTo(50, 50);
          context.lineTo(120, 50);
          context.lineTo(120, 120);
          context.lineTo(50, 120);
          context.fillStyle = "#f0f";
          context.closePath();
          context.fill();
          context.restore();

          // ç›–ä½ç¬¬äºŒä¸ª
          context.save();
          context.beginPath();
          context.translate(50, 50); // å åŠ æ€§
          context.moveTo(50, 50);
          context.lineTo(120, 50);
          context.lineTo(120, 120);
          context.lineTo(50, 120);
          context.fillStyle = "#0ff";
          context.closePath();
          context.fill();
          context.restore();

          // ç›–ä½ç¬¬ä¸€ä¸ª
          context.save();
          context.beginPath();
          context.moveTo(50, 50);
          context.lineTo(120, 50);
          context.lineTo(120, 120);
          context.lineTo(50, 120);
          context.fillStyle = "#ff0";
          context.closePath();
          context.fill();
          context.restore();

          // ç»˜åˆ¶æ˜Ÿæ˜Ÿâ­
          function drawStar(x, y, R, r, color) {
            // let R = 100
            // let r = 40
            context.save();
            context.translate(x, y);
            context.beginPath();
            for (let i = 0; i < 5; i++) {
              // å¤–è§’
              context.lineTo(
                R * Math.cos(((18 + i * 72) / 180) * Math.PI),
                -R * Math.sin(((18 + i * 72) / 180) * Math.PI)
              );
              // å†…è§’
              context.lineTo(
                r * Math.cos(((54 + i * 72) / 180) * Math.PI),
                -r * Math.sin(((54 + i * 72) / 180) * Math.PI)
              );
            }
            context.fillStyle = color;
            context.closePath();
            context.fill();
            context.restore();
          }

          drawStar(150, 150, 100, 40, "yellow");
          drawStar(170, 170, 100, 40, "red");
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // rotate é»˜è®¤ç»•(0ï¼Œ0)æ—‹è½¬
          context.save();
          context.rotate((30 / 180) * Math.PI);
          context.strokeStyle = "red";
          context.strokeRect(100, 100, 100, 50);
          context.restore();

          context.save();
          context.rotate((-30 / 180) * Math.PI);
          context.strokeStyle = "red";
          context.strokeRect(100, 100, 100, 50);
          context.restore();

          // scale æ•´ä¸ªç”»å¸ƒæ”¾å¤§
          context.save();
          context.scale(2, 2);
          context.strokeStyle = "red";
          context.lineWidth = 1;
          context.strokeRect(50, 50, 100, 50);
          context.restore();

          // ç»˜åˆ¶æ˜Ÿæ˜Ÿâ­
          function drawStar(x, y, R, r, a, s, color) {
            // let R = 100
            // let r = 40
            context.save();
            context.translate(x, y);
            context.scale(s, s);
            context.rotate((a / 180) * Math.PI);
            context.beginPath();
            for (let i = 0; i < 5; i++) {
              // å¤–è§’
              context.lineTo(
                R * Math.cos(((18 + i * 72) / 180) * Math.PI),
                -R * Math.sin(((18 + i * 72) / 180) * Math.PI)
              );
              // å†…è§’
              context.lineTo(
                r * Math.cos(((54 + i * 72) / 180) * Math.PI),
                -r * Math.sin(((54 + i * 72) / 180) * Math.PI)
              );
            }
            context.fillStyle = color;
            context.closePath();
            context.fill();
            context.restore();
          }
          drawStar(100, 100, 120, 50, 40, 1.2, "red");
        },
      });
      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // ç»˜åˆ¶æ˜Ÿç©º

          // ç»˜åˆ¶æ˜Ÿæ˜Ÿâ­
          function drawStar(x, y, R, r, a, s, color) {
            // let R = 100
            // let r = 40
            context.save();
            context.translate(x, y);
            context.scale(s, s);
            context.rotate((a / 180) * Math.PI);
            context.beginPath();
            for (let i = 0; i < 5; i++) {
              // å¤–è§’
              context.lineTo(
                R * Math.cos(((18 + i * 72) / 180) * Math.PI),
                -R * Math.sin(((18 + i * 72) / 180) * Math.PI)
              );
              // å†…è§’
              context.lineTo(
                r * Math.cos(((54 + i * 72) / 180) * Math.PI),
                -r * Math.sin(((54 + i * 72) / 180) * Math.PI)
              );
            }
            context.fillStyle = color;
            context.closePath();
            context.fill();
            context.restore();
          }
          context.fillStyle = "#000";
          context.fillRect(0, 0, canvas.width, canvas.height);
          for (let i = 0; i < 50; i++) {
            let x = Randoms.getRandomInt(0, canvas.width);
            let y = Randoms.getRandomInt(0, canvas.height);
            let a = Randoms.getRandomInt(0, 180);
            drawStar(x, y, 30, 15, a, 1, "yellow");
          }
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // arcTo ç»˜åˆ¶æ›²çº¿

          // å°è£…å¸¦æœ‰è¾…åŠ©çº¿çš„arcToæ–¹æ³•
          function drawArcTo(x1, y1, x2, y2, radius) {
            context.beginPath();
            context.moveTo(x1 - x2, y1);
            context.arcTo(...arguments);
            context.strokeStyle = "red";
            context.stroke();

            context.beginPath();
            context.moveTo(x1 - x2, y1);
            context.lineTo(x1, y1);
            context.lineTo(x2, y2);
            context.strokeStyle = "#808080";
            context.stroke();
          }

          drawArcTo(200, 100, 200, 200, 50);
          drawArcTo(240, 70, 200, 200, 50);
          drawArcTo(180, 140, 200, 200, 50);
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // ç»˜åˆ¶æœˆäº®
          let a = v2(40, 10);
          let b = v2(40, 70);
          let c = v2(120, 40);

          let R = (Vector2.distance(a, c) * 3) / 8;
          context.moveTo(a.x, a.y);
          context.arcTo(c.x, c.y, b.x, b.y, R);
          // åªèƒ½é€†æ—¶é’ˆç»˜åˆ¶
          context.arc(40, 40, 30, (1 / 2) * Math.PI, (3 / 2) * Math.PI, true);
          context.fillStyle = "yellow";
          context.fill();
          function drawMoon(a, b, c, color) {
            let R = (Vector2.distance(a, c) * 3) / 8;
            context.beginPath();
            context.moveTo(a.x, a.y);
            context.arcTo(c.x, c.y, b.x, b.y, R);
            // åªèƒ½é€†æ—¶é’ˆç»˜åˆ¶
            context.arc(
              a.x,
              (b.y - a.y) / 2 + a.y,
              (b.y - a.y) / 2,
              (1 / 2) * Math.PI,
              (3 / 2) * Math.PI,
              true
            );
            context.fillStyle = color;
            context.fill();
          }

          drawMoon(
            a.plus(v2(100, 0)),
            b.plus(v2(100, 0)),
            c.plus(v2(100, 0)),
            "red"
          );
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // ç»˜åˆ¶æœˆäº® è´å¡å°”äºŒæ¬¡æ›²çº¿
          let a = v2(40, 10);
          let b = v2(40, 70);
          let c = v2(120, 40);

          let R = (Vector2.distance(a, c) * 3) / 8;
          context.moveTo(a.x, a.y);
          context.arcTo(c.x, c.y, b.x, b.y, R);
          // åªèƒ½é€†æ—¶é’ˆç»˜åˆ¶
          context.arc(40, 40, 30, (1 / 2) * Math.PI, (3 / 2) * Math.PI, true);
          context.fillStyle = "yellow";
          context.fill();
          function drawMoon(a, b, c, color) {
            context.beginPath();
            context.moveTo(a.x, a.y);
            context.quadraticCurveTo(c.x, c.y, b.x, b.y);
            // åªèƒ½é€†æ—¶é’ˆç»˜åˆ¶
            context.arc(
              a.x,
              (b.y - a.y) / 2 + a.y,
              (b.y - a.y) / 2,
              (1 / 2) * Math.PI,
              (3 / 2) * Math.PI,
              true
            );
            context.fillStyle = color;
            context.fill();
          }

          drawMoon(
            a.plus(v2(100, 0)),
            b.plus(v2(100, 0)),
            c.plus(v2(60, 0)),
            "red"
          );
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // ç»˜åˆ¶è´å¡å°”ä¸‰æ¬¡æ›²çº¿
          let s = v2(10, 20);
          let a = v2(80, 10);
          let b = v2(40, 70);
          let c = v2(120, 40);

          context.beginPath();
          context.moveTo(s.x, s.y);
          context.bezierCurveTo(a.x, a.y, b.x, b.y, c.x, c.y);
          context.strokeStyle = "#f00";
          context.stroke();
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // æ–‡æœ¬æ¸²æŸ“
          context.font = "bold 20px Arial";
          context.textBaseline = "top";
          context.strokeStyle = "red";
          context.strokeText("Canvaså¥‡å¹»ä¹‹æ—…", 20, 20);
          context.fillStyle = "blue";
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 20, 80);
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // Fontå±æ€§è¯¦è§£
          context.textBaseline = "top";
          context.fillStyle = "blue";
          context.font = "italic normal normal 20px Arial";
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 20, 20);
          context.font = "oblique normal normal 20px Arial";
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 20, 80);
          context.font = "normal small-caps normal 20px Arial";
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 20, 140);
          context.font = "normal normal bold 20px Arial";
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 20, 200);
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // textAlign
          context.textBaseline = "top";
          context.fillStyle = "blue";
          context.textAlign = "left";
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 150, 20);
          context.textAlign = "center";
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 150, 60);
          context.textAlign = "right";
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 150, 100);
          // textBaseLine
          context.textAlign = "center";
          context.textBaseline = "top";
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 150, 140);
          context.textBaseline = "middle";
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 150, 180);
          context.textBaseline = "bottom";
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 150, 220);

          // è¾…åŠ©çº¿
          context.beginPath();
          context.moveTo(150, 0);
          context.lineTo(150, 300);
          context.stroke();
          context.beginPath();
          context.moveTo(0, 140);
          context.lineTo(300, 140);
          context.stroke();
          context.beginPath();
          context.moveTo(0, 180);
          context.lineTo(300, 180);
          context.stroke();
          context.beginPath();
          context.moveTo(0, 220);
          context.lineTo(300, 220);
          context.stroke();
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // æ–‡æœ¬çš„åº¦é‡
          context.textBaseline = "top";
          context.fillStyle = "blue";
          context.font = "italic normal normal 20px Arial";
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 20, 20);
          let measureText = context.measureText("Canvaså¥‡å¹»ä¹‹æ—…");
          console.log(measureText.width);
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // é˜´å½±æ•ˆæœ
          context.font = "italic normal 600 20px Arial";
          context.shadowColor = "blue";
          context.shadowOffsetX = 5;
          context.shadowOffsetY = 5;
          context.shadowBlur = 2;
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 20, 150);
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // çº¿æ€§æ¸å˜
          let linearGradient = context.createLinearGradient(0, 0, 150, 150);
          linearGradient.addColorStop(0, "#0aa");
          linearGradient.addColorStop(1, "#eef");
          context.fillStyle = linearGradient;
          context.fillRect(0, 0, 150, 150);
          // å¾„å‘æ¸å˜
          let radialGradient = context.createRadialGradient(
            225,
            75,
            0,
            225,
            75,
            75
          );
          radialGradient.addColorStop(0, "#f00");
          radialGradient.addColorStop(1, "#fff");
          context.fillStyle = radialGradient;
          context.fillRect(150, 0, 150, 150);
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // å½©è™¹ğŸŒˆ
          let linearGradient = context.createRadialGradient(
            150,
            150,
            50,
            150,
            150,
            75
          );
          linearGradient.addColorStop(0, "purple");
          linearGradient.addColorStop(0.167, "blue");
          linearGradient.addColorStop(0.334, "turquoise");
          linearGradient.addColorStop(0.501, "green");
          linearGradient.addColorStop(0.668, "yellow");
          linearGradient.addColorStop(0.835, "orange");
          linearGradient.addColorStop(1, "red");
          context.fillStyle = linearGradient;

          context.beginPath();
          context.arc(150, 150, 50, 0, Math.PI, true);
          context.arc(150, 150, 75, Math.PI, 0);
          context.closePath();
          // context.stroke();
          context.fill();
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // ä»¥å›¾ç‰‡æˆ–ç”»å¸ƒä½œä¸ºç”»å¸ƒèƒŒæ™¯
          let image = new Image();
          image.src = "./assets/lianliankan/mask.png";
          image.style.objectFit = "cover";
          image.onload = () => {
            let patternNo = context.createPattern(image, "no-repeat");
            context.fillStyle = patternNo;
            context.fillRect(0, 0, 150, 100);
            let patternR = context.createPattern(image, "repeat");
            context.fillStyle = patternR;
            context.fillRect(150, 0, 150, 100);

            let patternX = context.createPattern(image, "repeat-x");
            context.fillStyle = patternX;
            context.fillRect(0, 150, 150, 100);

            let patternY = context.createPattern(image, "repeat-y");
            context.fillStyle = patternY;
            context.fillRect(150, 150, 150, 100);
          };
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // clipè£å‰ªåŒºåŸŸ
          context.beginPath();
          context.fillStyle = "#333";
          context.fillRect(0, 0, canvas.width, canvas.height);
          context.closePath();

          context.beginPath();
          context.arc(150, 150, 40, 0, Math.PI * 2);
          context.fillStyle = "#fff";
          context.closePath();
          context.fill();
          context.clip();

          context.font = "bold 40px Arial";
          context.fillStyle = "blue";
          context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 150, 150);
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // æ¢ç…§ç¯
          let light = {
            x: 150,
            y: 150,
            R: 40,
            vx: 3,
            vy: 3,
          };
          let render = () => {
            context.clearRect(0, 0, canvas.width, canvas.height);
            context.save();

            context.beginPath();
            context.fillStyle = "#333";
            context.fillRect(0, 0, canvas.width, canvas.height);
            context.closePath();
            context.beginPath();
            context.arc(light.x, light.y, light.R, 0, Math.PI * 2);
            context.fillStyle = "#fff";
            context.closePath();
            context.fill();
            context.clip();

            context.font = "bold 40px Arial";
            context.fillStyle = "blue";
            context.fillText("Canvaså¥‡å¹»ä¹‹æ—…", 150, 150);
            context.restore();
          };
          let update = () => {
            // light.x += light.vx;
            // light.y += light.vy
            // // å³
            // if (light.x + light.R >= canvas.width) {
            //     light.x = canvas.width - light.R;
            //     light.vx = -light.vx
            // }
            // // å·¦
            // if (light.x - light.R <= 0) {
            //     light.x = light.R;
            //     light.vx = -light.vx
            // }

            // // ä¸‹
            // if (light.y + light.R >= canvas.height) {
            //     light.y = canvas.height - light.R;
            //     light.vy = -light.vy
            // }
            // // ä¸Š
            // if (light.y - light.R <= 0) {
            //     light.y = light.R;
            //     light.vy = -light.vy
            // }

            light.R += 2;
            if (light.R >= 50) {
              light.R = 0;
            }
          };

          let run = () => {
            setInterval(() => {
              render();
              update();
            }, 20);
          };

          run();
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // åˆ¤æ–­æŸä¸ªç‚¹æ˜¯å¦åœ¨æ‰€æ„å»ºçš„è·¯å¾„å†…
          context.beginPath();
          context.arc(150, 150, 75, 0, Math.PI * 2);
          context.closePath();
          context.stroke();

          let isPointInPathRes = context.isPointInPath(150, 80);
          console.log(isPointInPathRes);
          if (isPointInPathRes) {
            console.log("åœ¨åœˆå†…");
          } else {
            console.log("ä¸åœ¨åœˆå†…");
          }

          context.fillRect(150, 80, 2, 2);
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // ä½¿ç”¨isPointInPathå®ç°é¼ æ ‡äº¤äº’
          canvas.addEventListener("mousedown", (ev) => {
            let x = ev.clientX - canvas.getBoundingClientRect().left;
            let y = ev.clientY - canvas.getBoundingClientRect().top;

            render(x, y);
          });

          let render = (x, y) => {
            context.clearRect(0, 0, canvas.width, canvas.height);
            // âšª
            context.beginPath();
            context.arc(150, 150, 75, 0, Math.PI * 2);
            let isPointInPathRes = context.isPointInPath(x, y);
            if (isPointInPathRes) {
              context.fillStyle = "red";
            } else {
              context.fillStyle = "blue";
            }
            context.closePath();
            context.fill();

            // â– 
            context.beginPath();
            context.moveTo(0, 0);
            context.lineTo(0, 50);
            context.lineTo(50, 50);
            context.lineTo(50, 0);
            isPointInPathRes = context.isPointInPath(x, y);
            if (isPointInPathRes) {
              context.fillStyle = "red";
            } else {
              context.fillStyle = "blue";
            }
            context.closePath();
            context.fill();

            // â–²
            context.beginPath();
            context.moveTo(300, 300);
            context.lineTo(250, 300);
            context.lineTo(300, 250);
            isPointInPathRes = context.isPointInPath(x, y);
            if (isPointInPathRes) {
              context.fillStyle = "red";
            } else {
              context.fillStyle = "blue";
            }
            context.closePath();
            context.fill();
          };

          render();
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          let cy = 75;
          // globalAlphaå±æ€§
          context.font = "bold 12px Arial";
          context.textAlign = "center";
          context.textBaseline = "top";
          context.fillText("globalAlpha", 90, cy - 70);
          context.beginPath();
          context.arc(75, cy, 60, 0, Math.PI * 2);
          context.fillStyle = "purple";
          context.globalAlpha = 0.5;
          context.closePath();
          context.fill();
          context.beginPath();
          context.arc(75 + 30, cy, 60, 0, Math.PI * 2);
          context.fillStyle = "blue";
          context.globalAlpha = 0.2;
          context.closePath();
          context.fill();

          // globalCompositeOperationå±æ€§
          let globalCompositeOperationArr = [
            "source-over", // é¢„è®¾å€¼ã€‚å°†æ–°å›¾å½¢æ”¾åœ¨æ—§å›¾å½¢ä¹‹ä¸Šã€‚
            "destination-over", // å°†æ–°å›¾å½¢æ”¾åœ¨æ—§å›¾å½¢ä¹‹ä¸‹ã€‚
            "source-in", // åªä¿ç•™æ–°ã€æ—§å›¾ç‰‡é‡å çš„æ–°åœ†å½¢åŒºåŸŸï¼Œå…¶ä½™é€æ˜ã€‚
            "destination-in", // åªä¿ç•™æ–°ã€æ—§å›¾ç‰‡é‡å çš„æ–°åœ†å½¢åŒºåŸŸï¼Œå…¶ä½™é€æ˜ã€‚
            "source-out", // åªä¿ç•™æ–°ã€æ—§å›¾åƒçš„éé‡å çš„æ–°åœ†å½¢åŒºåŸŸï¼Œå…¶ä½™ä¸ºé€æ˜ã€‚
            "destination-out", // åªä¿ç•™æ–°ã€æ—§å›¾åƒçš„éé‡å çš„æ—§åœ†å½¢åŒºåŸŸï¼Œå…¶ä½™ä¸ºé€æ˜ã€‚
            "source-atop", // æ–°åœ†å½¢åªåœ¨ç»˜åˆ¶æ–°ã€æ—§å›¾åƒé‡å çš„æ–°åœ†å½¢åŒºåŸŸï¼Œç„¶åç›–åœ¨æ—§å›¾å½¢ä¹‹ä¸Š
            "destination-atop", // æ—§å›¾å½¢åªä¿ç•™åœ¨æ–°ã€æ—§å›¾å½¢é‡å çš„æ—§åœ†å½¢åŒºåŸŸï¼Œç„¶åç›–åœ¨æ–°åœ†å½¢ä¹‹ä¸Šã€‚
            "lighter", // æ–°æ—§å›¾åƒé‡å åŒºåŸŸçš„é¢œè‰²ï¼Œæœ‰æ–°ã€æ—§å›¾åƒçš„é¢œè‰²å—ç›¸åŠ è€Œå¾—
            "xor", // æ–°æ—§å›¾åƒé‡å åŒºåŸŸè®¾ä¸ºé€æ˜
            "copy", // ç§»é™¤å…¶ä»–å›¾åƒï¼Œåªä¿ç•™æ–°å›¾å½¢
          ];

          let currentIdx = 0;

          setInterval(() => {
            context.clearRect(0, 0, canvas.width, canvas.height);
            // globalCompositeOperationå±æ€§
            context.fillStyle = "#000";
            context.globalAlpha = 1;
            let item = globalCompositeOperationArr[currentIdx];
            console.log(item);
            context.globalCompositeOperation = item;
            context.beginPath();
            context.arc(75, cy, 60, 0, Math.PI * 2);
            context.fillStyle = "purple";
            context.closePath();
            context.fill();
            context.beginPath();
            context.arc(75 + 30, cy, 60, 0, Math.PI * 2);
            context.fillStyle = "blue";
            context.closePath();
            context.fill();
            context.fillText(item, 90, cy - 70);
            currentIdx++;
            if (currentIdx >= globalCompositeOperationArr.length) {
              currentIdx = 0;
            }
          }, 2000);
        },
      });

      createCanvas({
        width: 300,
        height: 300,
        render: ({ canvas, context }) => {
          // éé›¶ç¯ç»•è§„åˆ™
          var w = canvas.width,
            h = canvas.height;

          var x = w / 2,
            y = h / 2,
            r = 100,
            start = -Math.PI / 2,
            end = (Math.PI * 3) / 2;

          context.arc(x, y, r, start, end);
          context.fillStyle = "#D43D59";
          context.fill();
          context.beginPath();
          context.moveTo(x, y - r);
          // é¡¶ç‚¹è¿ä¸‹å·¦
          context.lineTo(
            x - r * Math.sin(Math.PI / 5),
            y + r * Math.cos(Math.PI / 5)
          );

          // ä¸‹å·¦è¿ä¸Šå³
          context.lineTo(
            x + r * Math.cos(Math.PI / 10),
            y - r * Math.sin(Math.PI / 10)
          );
          // ä¸Šå³è¿ä¸Šå·¦
          context.lineTo(
            x - r * Math.cos(Math.PI / 10),
            y - r * Math.sin(Math.PI / 10)
          );
          // ä¸Šå·¦è¿ä¸‹å³
          context.lineTo(
            x + r * Math.sin(Math.PI / 5),
            y + r * Math.cos(Math.PI / 5)
          );
          context.fillStyle = "#246AB2";
          // fillå¡«å……è§„åˆ™---å¥‡å¶åŸåˆ™
          context.fill("evenodd");
        },
      });
    </script>
  </body>
</html>
